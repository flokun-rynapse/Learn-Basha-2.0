<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Learn Basha 2.0</title>
    <style>
        :root { --primary: #FF4757; --secondary: #2ED573; --accent: #1E90FF; --bg: #F1F2F6; }
        
        /* Fixed height issue for mobile */
        body { 
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif; 
            margin: 0; 
            padding: 0;
            background-color: #2F3542; 
            display: flex; 
            justify-content: center; 
            height: 100vh; 
            height: 100dvh; 
            overflow: hidden; 
        }

        .app-shell { 
            width: 100%; 
            max-width: 414px; 
            background: var(--bg); 
            display: flex; 
            flex-direction: column; 
            position: relative;
            height: 100%;
        }
        
        /* Navigation Bottom Bar Fix */
        .bottom-nav { 
            display: flex; 
            background: #ffffff; 
            border-top: 2px solid #ddd; 
            height: 70px; 
            min-height: 70px;
            width: 100%;
            position: relative;
            z-index: 9999;
        }

        .nav-btn { 
            flex: 1; 
            border: none; 
            background: none; 
            cursor: pointer; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            color: #57606F; 
            padding: 5px;
        }

        .nav-btn.active { color: var(--primary); }
        .nav-btn span { font-size: 1.5rem; }

        /* Scrollable Container */
        .view-container { 
            flex: 1; 
            overflow-y: auto; 
            display: none; 
            -webkit-overflow-scrolling: touch; 
        }
        .view-container.active { display: flex; flex-direction: column; }

        /* --- STYLES FROM CODE 1 --- */
        header { background: white; padding: 15px; text-align: center; border-bottom: 4px solid var(--primary); }
        .lang-switch { display: flex; padding: 10px; gap: 10px; background: white; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 15px; font-size: 1.1rem; font-weight: bold; cursor: pointer; background: #dfe4ea; }
        .btn-ml.active { background: var(--secondary); color: white; }
        .btn-en.active { background: var(--accent); color: white; }
        #content-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; padding: 15px; }
        .card { background: white; border-radius: 20px; padding: 20px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-bottom: 5px solid #ddd; cursor: pointer; }
        .card:active { transform: translateY(4px); border-bottom: 2px solid #ddd; }
        .letter-display { font-size: 3.5rem; font-weight: bold; color: #2F3542; display: block; }
        .word-display { font-size: 1.2rem; color: #57606F; margin-top: 5px; display: block; }
        .emoji { font-size: 2rem; display: block; margin-bottom: 5px; }
        footer { background: white; padding: 15px; text-align: center; font-weight: bold; color: var(--primary); margin-top: auto; }

        /* --- STYLES FROM CODE 2 --- */
        .phone-frame { width: 100%; height: 100%; background: #fff; display: flex; flex-direction: column; }
        .g-header { background: #2980b9; color: white; padding: 15px; text-align: center; }
        #score { font-size: 24px; font-weight: bold; }
        .game-area { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; background: #ecf0f1; }
        #drop-zone { width: 90%; min-height: 60px; background: white; border: 3px dashed #bdc3c7; border-radius: 15px; display: flex; justify-content: center; align-items: center; gap: 5px; margin-bottom: 10px; }
        .letters-pool { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 20px; background: #dfe6e9; }
        .letter-tile { width: 45px; height: 45px; background: #3498db; color: white; border-radius: 8px; display: flex; justify-content: center; align-items: center; font-size: 20px; font-weight: bold; box-shadow: 0 4px #2980b9; touch-action: none; }
        .g-submit { background: #27ae60; color: white; border: none; padding: 15px; font-size: 18px; border-radius: 30px; cursor: pointer; width: 85%; margin-bottom: 10px; font-weight: bold; }
        #clear-btn { background: #e67e22; }
        .g-footer { background: #34495e; color: #bdc3c7; text-align: center; padding: 10px; font-size: 14px; font-weight: bold; }

        /* Overlays */
        #offline-overlay, #win-screen { display: none; position: absolute; inset: 0; flex-direction: column; justify-content: center; align-items: center; z-index: 10000; text-align: center; padding: 20px; }
        #offline-overlay { background: rgba(0,0,0,0.9); color: white; }
        #win-screen { background: rgba(255,255,255,0.95); }
    </style>
</head>
<body>

<div class="app-shell">
    <div id="offline-overlay">
        <div style="font-size: 50px;">üì°</div>
        <h2>Offline</h2>
        <p>Internet required for voice and word check.</p>
    </div>

    <div id="view-learn" class="view-container active">
        <header><h2 style="margin:0; color:var(--primary)">üçé Let's Learn!</h2></header>
        <div class="lang-switch">
            <button class="btn btn-ml active" onclick="loadContent('ml')">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
            <button class="btn btn-en" onclick="loadContent('en')">English</button>
        </div>
        <div id="content-grid"></div>
        <footer>GHSS Koduvally (Clikture)</footer>
    </div>

    <div id="view-game" class="view-container">
        <div class="phone-frame">
            <div class="g-header">
                <div>WORDS FOUND</div>
                <div id="score">0 / 10</div>
            </div>
            <div class="game-area">
                <div id="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                <button class="g-submit" onclick="checkWord()">SUBMIT WORD</button>
                <button class="g-submit" id="clear-btn" onclick="clearDropZone()">CLEAR</button>
                <p id="status-msg" style="text-align: center; font-weight: bold; min-height: 20px;"></p>
            </div>
            <div class="letters-pool" id="pool"></div>
            <div class="g-footer">GHSS Koduvally</div>
            <div id="win-screen">
                <div style="font-size: 80px;">üèÜ</div>
                <h1>CHAMPION!</h1>
                <button class="g-submit" onclick="location.reload()" style="width: auto;">PLAY AGAIN</button>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <button class="nav-btn active" id="nav-l" onclick="showView('learn')"><span>üìñ</span>Learn</button>
        <button class="nav-btn" id="nav-g" onclick="showView('game')"><span>üéÆ</span>Play</button>
    </nav>
</div>

<script>
    function showView(view) {
        document.getElementById('view-learn').classList.toggle('active', view === 'learn');
        document.getElementById('view-game').classList.toggle('active', view === 'game');
        document.getElementById('nav-l').classList.toggle('active', view === 'learn');
        document.getElementById('nav-g').classList.toggle('active', view === 'game');
        if(view === 'game') generateLetters();
    }

    function updateOnlineStatus() {
        document.getElementById('offline-overlay').style.display = navigator.onLine ? 'none' : 'flex';
    }
    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);

    const data = {
        ml: [
            {l:'‡¥Ö', w:'‡¥Ö‡¥Æ‡µç‡¥Æ', e:'üë©‚Äçüë¶', s:'Amma'}, {l:'‡¥Ü', w:'‡¥Ü‡¥®', e:'üêò', s:'Aana'},
            {l:'‡¥á', w:'‡¥á‡¥≤', e:'üçÉ', s:'Ila'}, {l:'‡¥à', w:'‡¥à‡¥ö‡µç‡¥ö', e:'ü™∞', s:'Eecha'},
            {l:'‡¥â', w:'‡¥â‡¥∞‡µΩ', e:'ü•£', s:'Ural'}, {l:'‡¥ä', w:'‡¥ä‡¥û‡µç‡¥û‡¥æ‡µΩ', e:'ü™ë', s:'Oonjal'},
            {l:'‡¥ã', w:'‡¥ã‡¥∑‡¥ø', e:'üßò', s:'Rishi'}, {l:'‡¥é', w:'‡¥é‡¥≤‡¥ø', e:'üê≠', s:'Eli'},
            {l:'‡¥è', w:'‡¥è‡¥£‡¥ø', e:'ü™ú', s:'Eni'}, {l:'‡¥ê', w:'‡¥ê‡¥∏‡µç', e:'üßä', s:'Ice'},
            {l:'‡¥í', w:'‡¥í‡¥ü‡µç‡¥ü‡¥ï‡¥Ç', e:'üê™', s:'Ottakam'}, {l:'‡¥ì', w:'‡¥ì‡¥®‡µç‡¥§‡µç', e:'ü¶é', s:'Oanthu'},
            {l:'‡¥î', w:'‡¥î‡¥∑‡¥ß‡¥Ç', e:'üíä', s:'Oushadham'}, {l:'‡¥ï', w:'‡¥ï‡¥£‡µç‡¥£‡¥æ‡¥ü‡¥ø', e:'ü™û', s:'Kannadi'},
            {l:'‡¥ó', w:'‡¥ó‡¥ú‡¥Ç', e:'üêò', s:'Gajam'}, {l:'‡¥Æ', w:'‡¥Æ‡¥∞‡¥Ç', e:'üå≥', s:'Maram'}
        ],
        en: [
            {l:'A', w:'Apple', e:'üçé'}, {l:'B', w:'Ball', e:'‚öΩ'}, {l:'C', w:'Cat', e:'üê±'},
            {l:'D', w:'Dog', e:'üê∂'}, {l:'E', w:'Egg', e:'ü•ö'}, {l:'F', w:'Fish', e:'üêü'},
            {l:'G', w:'Grapes', e:'üçá'}, {l:'H', w:'Hat', e:'üé©'}, {l:'I', w:'Igloo', e:'‚ùÑÔ∏è'}
        ]
    };

    function loadContent(lang) {
        const container = document.getElementById('content-grid');
        container.innerHTML = '';
        document.querySelector('.btn-ml').classList.toggle('active', lang === 'ml');
        document.querySelector('.btn-en').classList.toggle('active', lang === 'en');
        data[lang].forEach(item => {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => {
                window.speechSynthesis.cancel();
                const msg = new SpeechSynthesisUtterance(lang === 'en' ? `${item.l} for ${item.w}` : item.s);
                msg.lang = lang === 'ml' ? 'ml-IN' : 'en-US';
                msg.rate = 0.6; msg.pitch = 1.6;
                window.speechSynthesis.speak(msg);
            };
            card.innerHTML = `<span class="emoji">${item.e}</span><span class="letter-display">${item.l}</span><span class="word-display">${item.w}</span>`;
            container.appendChild(card);
        });
    }

    let gameScore = 0;
    function generateLetters() {
        const p = document.getElementById('pool');
        if(p.children.length > 0) return;
        const chars = "EEEEAAIIOOOOTTTNNNRRRSSSLDDUU"; 
        for(let i=0; i<12; i++) {
            let div = document.createElement('div');
            div.className = 'letter-tile';
            div.innerText = chars[Math.floor(Math.random() * chars.length)];
            div.onclick = () => document.getElementById('drop-zone').appendChild(div);
            p.appendChild(div);
        }
    }

    function allowDrop(ev) { ev.preventDefault(); }
    function drop(ev) { ev.preventDefault(); let id = ev.dataTransfer.getData("text"); let tile = document.getElementById(id); if(tile) document.getElementById('drop-zone').appendChild(tile); }
    function clearDropZone() { Array.from(document.getElementById('drop-zone').children).forEach(t => document.getElementById('pool').appendChild(t)); }

    async function checkWord() {
        let dz = document.getElementById('drop-zone');
        let word = Array.from(dz.children).map(t => t.innerText).join('').toLowerCase();
        let m = document.getElementById('status-msg');
        if(word.length < 2) return;
        m.innerText = "Checking...";
        try {
            const r = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
            if(r.ok) {
                gameScore++;
                document.getElementById('score').innerText = `${gameScore} / 10`;
                m.innerText = "‚úÖ Valid!";
                dz.innerHTML = '';
                generateLetters();
                if(gameScore >= 10) document.getElementById('win-screen').style.display = 'flex';
            } else { m.innerText = "‚ùå Invalid!"; }
        } catch (e) { updateOnlineStatus(); }
    }

    loadContent('ml');
</script>

</body>
</html>
